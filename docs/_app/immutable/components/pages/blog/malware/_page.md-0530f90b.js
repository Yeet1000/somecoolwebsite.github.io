import{S as ce,i as we,s as _e,k as s,q as m,a as f,l as a,m as p,r as d,h as e,c as r,I as n,n as u,b as l,C as o,B as Wt}from"../../../../chunks/index-fcc4e8f5.js";function ve(ne){let c,_t,X,w,vt,Y,_,yt,Z,v,bt,$,y,xt,g,b,x,At,tt,E,Et,et,I,It,it,P,k,Nt,lt,M,Pt,st,T,G,St,at,C,kt,ot,D,q,Bt,pt,H,Mt,ft,K,O,jt,rt,W,Tt,mt,A,N,zt,dt,h,Gt,Q,Ct,Dt,R,qt,Ht,ut,S,B,Ft,ht,j,Kt,nt,z,Ot,ct,F,U,Jt,wt,J,V,Lt;return{c(){c=s("h1"),_t=m("Malware analysis/Honepot stuff."),X=f(),w=s("p"),vt=m("This is where I upload my findings in analysing malware from my honeypot"),Y=f(),_=s("h2"),yt=m("> Mirai sample - 5/5/22"),Z=f(),v=s("p"),bt=m("found a cool malware sample on my honeypot!"),$=f(),y=s("p"),xt=m("I first strings\u2019ed it"),g=f(),b=s("p"),x=s("img"),tt=f(),E=s("p"),Et=m("and it gave me some interesting text (which lead me to believe it is a http c2 client)"),et=f(),I=s("p"),It=m("There was also a lot of repeating weird text so i scanned it with yara"),it=f(),P=s("p"),k=s("img"),lt=f(),M=s("p"),Pt=m("and found that it contained xored data. I then xor bruteforced it with cyberchef and found some text which resembled http headers with the key 0x4d"),st=f(),T=s("p"),G=s("img"),at=f(),C=s("p"),kt=m("Obviously I copied the entire bit of seemingly xored in but it didn\u2019t look nice"),ot=f(),D=s("p"),q=s("img"),pt=f(),H=s("p"),Mt=m("so i found a tool called xcat on github and ran it on the binary with the key"),ft=f(),K=s("p"),O=s("img"),rt=f(),W=s("p"),Tt=m("This produced more coherent text, but that still needed some cleaning so i piped that output into strings"),mt=f(),A=s("p"),N=s("img"),dt=f(),h=s("p"),Gt=m("The thing that stood out the most to me was the "),Q=s("code"),Ct=m("/bin/busybox WICKED"),Dt=m(" and "),R=s("code"),qt=m("WICKED: applet not found"),Ht=m(" so I did a quick google and that yielded a bunch of results talking about the \u2018wicked family of bots\u2019"),ut=f(),S=s("p"),B=s("img"),ht=f(),j=s("p"),Kt=m("This showed me that I have a mirai botnet sample!"),nt=f(),z=s("p"),Ot=m("I also uploaded it to virustotal and saw that it was first submitted 4 days ago AND came from the same IP address in my honeypot logs"),ct=f(),F=s("p"),U=s("img"),wt=f(),J=s("p"),V=s("img"),this.h()},l(t){c=a(t,"H1",{});var i=p(c);_t=d(i,"Malware analysis/Honepot stuff."),i.forEach(e),X=r(t),w=a(t,"P",{});var Qt=p(w);vt=d(Qt,"This is where I upload my findings in analysing malware from my honeypot"),Qt.forEach(e),Y=r(t),_=a(t,"H2",{});var Rt=p(_);yt=d(Rt,"> Mirai sample - 5/5/22"),Rt.forEach(e),Z=r(t),v=a(t,"P",{});var Ut=p(v);bt=d(Ut,"found a cool malware sample on my honeypot!"),Ut.forEach(e),$=r(t),y=a(t,"P",{});var Vt=p(y);xt=d(Vt,"I first strings\u2019ed it"),Vt.forEach(e),g=r(t),b=a(t,"P",{});var Xt=p(b);x=a(Xt,"IMG",{src:!0,alt:!0}),Xt.forEach(e),tt=r(t),E=a(t,"P",{});var Yt=p(E);Et=d(Yt,"and it gave me some interesting text (which lead me to believe it is a http c2 client)"),Yt.forEach(e),et=r(t),I=a(t,"P",{});var Zt=p(I);It=d(Zt,"There was also a lot of repeating weird text so i scanned it with yara"),Zt.forEach(e),it=r(t),P=a(t,"P",{});var $t=p(P);k=a($t,"IMG",{src:!0,alt:!0}),$t.forEach(e),lt=r(t),M=a(t,"P",{});var gt=p(M);Pt=d(gt,"and found that it contained xored data. I then xor bruteforced it with cyberchef and found some text which resembled http headers with the key 0x4d"),gt.forEach(e),st=r(t),T=a(t,"P",{});var te=p(T);G=a(te,"IMG",{src:!0,alt:!0}),te.forEach(e),at=r(t),C=a(t,"P",{});var ee=p(C);kt=d(ee,"Obviously I copied the entire bit of seemingly xored in but it didn\u2019t look nice"),ee.forEach(e),ot=r(t),D=a(t,"P",{});var ie=p(D);q=a(ie,"IMG",{src:!0,alt:!0}),ie.forEach(e),pt=r(t),H=a(t,"P",{});var le=p(H);Mt=d(le,"so i found a tool called xcat on github and ran it on the binary with the key"),le.forEach(e),ft=r(t),K=a(t,"P",{});var se=p(K);O=a(se,"IMG",{src:!0,alt:!0}),se.forEach(e),rt=r(t),W=a(t,"P",{});var ae=p(W);Tt=d(ae,"This produced more coherent text, but that still needed some cleaning so i piped that output into strings"),ae.forEach(e),mt=r(t),A=a(t,"P",{});var oe=p(A);N=a(oe,"IMG",{src:!0,alt:!0}),oe.forEach(e),dt=r(t),h=a(t,"P",{});var L=p(h);Gt=d(L,"The thing that stood out the most to me was the "),Q=a(L,"CODE",{});var pe=p(Q);Ct=d(pe,"/bin/busybox WICKED"),pe.forEach(e),Dt=d(L," and "),R=a(L,"CODE",{});var fe=p(R);qt=d(fe,"WICKED: applet not found"),fe.forEach(e),Ht=d(L," so I did a quick google and that yielded a bunch of results talking about the \u2018wicked family of bots\u2019"),L.forEach(e),ut=r(t),S=a(t,"P",{});var re=p(S);B=a(re,"IMG",{src:!0,alt:!0}),re.forEach(e),ht=r(t),j=a(t,"P",{});var me=p(j);Kt=d(me,"This showed me that I have a mirai botnet sample!"),me.forEach(e),nt=r(t),z=a(t,"P",{});var de=p(z);Ot=d(de,"I also uploaded it to virustotal and saw that it was first submitted 4 days ago AND came from the same IP address in my honeypot logs"),de.forEach(e),ct=r(t),F=a(t,"P",{});var ue=p(F);U=a(ue,"IMG",{src:!0}),ue.forEach(e),wt=r(t),J=a(t,"P",{});var he=p(J);V=a(he,"IMG",{src:!0}),he.forEach(e),this.h()},h(){n(x.src,At="https://media.discordapp.net/attachments/872259045820600325/971574427491893248/unknown.png?width=289&height=149")||u(x,"src",At),u(x,"alt","strings output"),n(k.src,Nt="https://media.discordapp.net/attachments/872259045820600325/971574427294765056/unknown.png?width=291&height=85")||u(k,"src",Nt),u(k,"alt","yara rule alerting to the prescense of xored data"),n(G.src,St="https://media.discordapp.net/attachments/872259045820600325/971574427710021673/unknown.png?width=822&height=465")||u(G,"src",St),u(G,"alt","cyberchef xor bruteforce"),n(q.src,Bt="https://media.discordapp.net/attachments/872259045820600325/971574427991019520/unknown.png?width=512&height=347")||u(q,"src",Bt),u(q,"alt","decoding the whole bit of the xored data"),n(O.src,jt="https://media.discordapp.net/attachments/872259045820600325/971574428246880296/unknown.png?width=906&height=472")||u(O,"src",jt),u(O,"alt","xor decoded data for the whole file using xcat"),n(N.src,zt="https://media.discordapp.net/attachments/872259045820600325/971574428645347328/unknown.png?width=206&height=472")||u(N,"src",zt),u(N,"alt","strings'ed xored data containing http headers and system calls"),n(B.src,Ft="https://media.discordapp.net/attachments/872259045820600325/971574428972490812/unknown.png?width=527&height=472")||u(B,"src",Ft),u(B,"alt","search results about 'wicked' malware"),n(U.src,Jt="https://cdn.discordapp.com/attachments/872259045820600325/971574429249331250/unknown.png")||u(U,"src",Jt),n(V.src,Lt="https://media.discordapp.net/attachments/872259045820600325/971574429505163264/unknown.png?width=960&height=61")||u(V,"src",Lt)},m(t,i){l(t,c,i),o(c,_t),l(t,X,i),l(t,w,i),o(w,vt),l(t,Y,i),l(t,_,i),o(_,yt),l(t,Z,i),l(t,v,i),o(v,bt),l(t,$,i),l(t,y,i),o(y,xt),l(t,g,i),l(t,b,i),o(b,x),l(t,tt,i),l(t,E,i),o(E,Et),l(t,et,i),l(t,I,i),o(I,It),l(t,it,i),l(t,P,i),o(P,k),l(t,lt,i),l(t,M,i),o(M,Pt),l(t,st,i),l(t,T,i),o(T,G),l(t,at,i),l(t,C,i),o(C,kt),l(t,ot,i),l(t,D,i),o(D,q),l(t,pt,i),l(t,H,i),o(H,Mt),l(t,ft,i),l(t,K,i),o(K,O),l(t,rt,i),l(t,W,i),o(W,Tt),l(t,mt,i),l(t,A,i),o(A,N),l(t,dt,i),l(t,h,i),o(h,Gt),o(h,Q),o(Q,Ct),o(h,Dt),o(h,R),o(R,qt),o(h,Ht),l(t,ut,i),l(t,S,i),o(S,B),l(t,ht,i),l(t,j,i),o(j,Kt),l(t,nt,i),l(t,z,i),o(z,Ot),l(t,ct,i),l(t,F,i),o(F,U),l(t,wt,i),l(t,J,i),o(J,V)},p:Wt,i:Wt,o:Wt,d(t){t&&e(c),t&&e(X),t&&e(w),t&&e(Y),t&&e(_),t&&e(Z),t&&e(v),t&&e($),t&&e(y),t&&e(g),t&&e(b),t&&e(tt),t&&e(E),t&&e(et),t&&e(I),t&&e(it),t&&e(P),t&&e(lt),t&&e(M),t&&e(st),t&&e(T),t&&e(at),t&&e(C),t&&e(ot),t&&e(D),t&&e(pt),t&&e(H),t&&e(ft),t&&e(K),t&&e(rt),t&&e(W),t&&e(mt),t&&e(A),t&&e(dt),t&&e(h),t&&e(ut),t&&e(S),t&&e(ht),t&&e(j),t&&e(nt),t&&e(z),t&&e(ct),t&&e(F),t&&e(wt),t&&e(J)}}}class be extends ce{constructor(c){super(),we(this,c,null,ve,_e,{})}}export{be as default};
